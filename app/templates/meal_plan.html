{% extends "base.html" %}
{% block title %}Create Meal Plan{% endblock %}
{% block content %}
    <h1>Create Meal Plan</h1>

    <form method="post" action="/recipes/export" id="recipes-export-form">
      <label>Language</label><br />
      <select name="lang">
        <option value="en">English</option>
        <option value="cs">Czech</option>
      </select>
      <br /><br />

      {% for category in ["breakfast", "lunch", "dinner", "snack"] %}
      <h2>{{ category | capitalize }}</h2>
      <ul>
        {% for r in recipes_by_category.get(category, []) %}
        <li>
          <label>
            <input type="checkbox" value="{{ r[0] }}" class="recipe-checkbox" />
            <strong>{{ r[1] }}</strong>
          </label>
        </li>
        {% endfor %}
      </ul>
      {% endfor %}
      <input type="hidden" name="recipe_ids" id="recipe-ids" />
      <button type="submit">Export selected recipes</button>
    </form>

    <script>
      const exportForm = document.getElementById("recipes-export-form");
      const recipeIds = document.getElementById("recipe-ids");

      exportForm.addEventListener("submit", () => {
        const selected = Array.from(
          document.querySelectorAll(".recipe-checkbox:checked")
        ).map((checkbox) => checkbox.value);
        recipeIds.value = selected.join(",");
      });
    </script>

    <a href="/">Back</a>
{% endblock %}
